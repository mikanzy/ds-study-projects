# Определение возраста покупателей магазина по фотографиям

## Описание

Построена нейронная сеть, которая по фотографии определяет возраст человека.

## Данные

Датасет для обучения и проверки качества модели — APPA-REAL (real and apparent age) с сайта [ChaLearn Looking at People](https://chalearnlap.cvc.uab.es/dataset/26/description/). 

Данные на сервере: 
- Набор файлов изображений с фотографией человека. 
- CSV-файл с разметкой: 
    - Имя файла с фотографией человека
    - Возраст человека на фото (целевой признак)


## Цель проекта

Построить модель, которая по фотографии определит приблизительный возраст человека.

Значение метрики *MAE* (Mean Absolute Error — средняя абсолютная ошибка) на тестовой выборке должно быть не больше 8. В статье об используемом датасете значение *MAE* равно 5.4. Значение *MAE* меньше 7 будет отличным результатом.


## Задачи проекта

1. Провести исследовательский анализ набора фотографий.

2. Подготовить данные к обучению.

3. Обучить нейронную сеть и оценить её качество.


## Используемые библиотеки
*matplotlib, numpy, pandas, PIL, scikit-learn, scipy, seaborn, tensorflow*


## Основные результаты

3. **Исследовательский анализ данных** показал:
    - Все изображения в датасете имеют формат JPEG и представлены в цветовой модели RGB. Подавляющее большинство изображений — квадратные. 
    - В датасете представлены фотографии людей различных рас и национальностей, полученные из разных открытых источников.
    - Распределения людей на фотографиях в датасете по возрасту в целом адекватно отражает распределение людей по возрасту в популяции.

4. Для решения задачи определения по фотографии возраста человека построена **модель — свёрточная нейронная сеть** на базе бэкбона `ResNet50`, предобученного на датасете ImageNet. Обучение модели на обучающей выборке из предоставленного датасета выполнено на сервере с GPU.

5. Построенная нейронная сеть хорошо предсказывает возраст человека по фотографии: средняя абсолютная ошибка (MAE) определения возраста человека на фотографии из тестовой выборки составила **менее 5.5**.
    
## Заключение

- Построенную нейросеть для определения возраста по фото можно использовать в сочетании с системой компьютерного зрения, обеспечивающей фотофиксацию лица покупателя в прикассовой зоне, чтобы анализировать покупки и предлагать товары, которые могут заинтересовать покупателей определённой возрастной группы. Предсказание возраста позволяет произвольно выделять возрастные группы для анализа, не меняя при этом используемую модель.

- Использование построенной нейросети для определения возраста покупателей при продаже алкоголя не рекомендуется по причине недостаточной точности модели (средняя ошибка определения возраста 5.5 лет). Для этой задачи лучше подойдёт модель бинарной классификации (старше или младше 18 лет человек на фото), настроенная на максимизацию полноты выявления лиц младше 18 лет.

- Чтобы повысить точность определения возраста, рекомендуется для обучения нейросети собрать репрезентативный датасет с фотографиями жителей местности, в которой её предполагается применять. Один из способов сделать это — фотофиксация покупателя при оплате на кассе при предъявлении им карты покупателя, привязанной к профилю, в котором указана дата рождения.