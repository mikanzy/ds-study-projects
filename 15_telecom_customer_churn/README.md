# Разработка модели машинного обучения для предсказания оттока клиентов оператора связи


## Данные

Cобранные оператором персональные данные о некоторых клиентах оператора связи, информацию об их тарифах и услугах:

1. `contract_new.csv` — информация о договоре:
    - `customerID` — идентификатор абонента;
    - `BeginDate` — дата начала действия договора;
    - `EndDate` — дата окончания действия договора;
    - `Type` — тип оплаты: раз в год-два или ежемесячно;
    - `PaperlessBilling` — электронный расчётный лист;
    - `PaymentMethod` — тип платежа;
    - `MonthlyCharges` — расходы за месяц;
    - `TotalCharges` — общие расходы абонента.

2. `personal_new.csv` — персональные данные клиента:
    - `customerID` — идентификатор пользователя;
    - `gender` — пол;
    - `SeniorCitizen` — является ли абонент пенсионером;
    - `Partner` — есть ли у абонента супруг или супруга;
    - `Dependents` — есть ли у абонента дети.

3. `internet_new.csv` — информация об интернет-услугах:
    - `customerID` — идентификатор пользователя;
    - `InternetService` — тип подключения;
    - `OnlineSecurity` — блокировка опасных сайтов;
    - `OnlineBackup` — облачное хранилище файлов для резервного копирования данных;
    - `DeviceProtection` — антивирус;
    - `TechSupport` — выделенная линия технической поддержки;
    - `StreamingTV` — стриминговое телевидение;
    - `StreamingMovies` — каталог фильмов.

4. `phone_new.csv` — информация об услугах телефонии:
    - `customerID` — идентификатор пользователя;
    - `MultipleLines` — подключение телефона к нескольким линиям одновременно.

Во всех файлах столбец `customerID` содержит код клиента. Информация о договорах актуальна на 1 февраля 2020 года.


## Цель проекта

Разработать модель для прогноза оттока клиентов, которая будет предсказывать, разорвёт ли абонент договор, на основе персональных данных о клиенте, а также информации о тарифе и используемых услугах. Тем, кто собирается отказаться от его услуг, оператор связи планирует предлагать промокоды и специальные условия.


## Задачи проекта

1. Загрузить исходные данные и провести их первичный осмотр.

2. Провести предобработку и исследовательский анализ каждой таблицы:
    - Обработать пропуски и дубликаты, преобразовать типы данных при необходимости. Проверить корректность и согласованность данных в таблицах.
    
3. Объединить таблицы по ключу — идентификатору абонента. 

4. Провести предобработку и исследовательский анализ объединённой таблицы:
    - Обработать пропуски и аномалий.
    
5. Сгенерировать признаки: целевой признак и прогнозирующие признаки (предикторы), которые будут использоваться для обучения ML моделей.

6. Провести исследовательский анализ данных:
    - Анализ статистических характеристик и визуализация распределений признаков с разбивкой по значению целевого признака (оттока).
    - Анализ корреляций прогнозирующих признаков между собой и с целевым признаком.
    - Проверить сбалансированности данных по значениям целевого признака (оттока).
    - Составить предварительный портрет типичного ушедшего абонента.
   
7. Подготовить данные для обучения моделей:
    - Выделить прогнозирующие и целевой признаки в отдельные переменные.
    - Разделить данные на обучающую и тестовую выборки. 
    - Преобразовать данные с учётом особенностей конкретных моделей.
    
8. Обучить несколько ML моделей различных типов, с помощью кросс-валидации на обучающей выборке подобрать для них оптимальные значения гиперпараметров, обеспечивающие максимальное значение метрики ROC-AUC.

9. Из обученных моделей выбрать лучшую и провести её анализ:
    - Проверить качество модели на тестовой выборке.
    - Проверить модель на адекватность (сравнение с дамми-моделью).
    - Анализ ошибок модели, расчёт и анализ метрик качества классификации.
    - Оценка значимости признаков и их влияния на предсказания модели.
    
10. Составить отчёт о проделанной работе.

11. Сделать выводы и дать рекомендации для бизнеса с учётом назначения модели.


## Используемые библиотеки
*catboost, matplotlib, numpy, optuna, pandas, phik, scikit-learn, seaborn, shap*

