# Определение стоимости автомобилей с пробегом

## Описание

Построена ML модель для определения стоимости автомобиля по его характеристикам.


## Данные

Исторические данные, включающие технические характеристики, комплектации и цены автомобилей:

- Дата скачивания анкеты из базы
- Тип автомобильного кузова
- Год регистрации автомобиля
- Тип коробки передач
- Мощность (л.с.)
- Модель автомобиля
- Пробег (км)
- Месяц регистрации автомобиля
- Тип топлива
- Марка автомобиля
- Была машина в ремонте или нет
- Дата создания анкеты
- Количество фотографий автомобиля
- Почтовый индекс пользователя
- Дата последней активности пользователя
- Цена (евро) — целевой признак


## Цель проекта

Построить модель для определения стоимости автомобиля по его характеристикам.

Критерии, которые важны заказчику:
- качество предсказания;
- время обучения модели;
- время предсказания модели.


## Задачи проекта

- Подготовить исходные данные для обучения моделей.

- Обучить разные модели, для каждой модели подобрать оптимальные гиперпараметры.

- Проанализировать время обучения, время предсказания и качество моделей.

- Опираясь на критерии заказчика, выбрать лучшую модель и проверить её качество на тестовой выборке.


## Используемые библиотеки
*catboost, lightgbm, matplotlib, numpy, optuna, pandas, phik, scikit-learn, seaborn, shap*


## Основные результаты

1. **Построена и обучена ML модель**, которая предсказывает стоимость автомобиля по его характеристикам, обеспечивая хорошее качество предсказаний и при этом приемлемые затраты времени на обучение и предсказание. 

2. **Анализ построенной модели** показал:
    - Иногда модель может выдавать отрицательные предсказания цены, которые нужно приводить к нулю.
    - Наиболее значимыми признаками для предсказания цены автомобиля являются (в порядке убывания важности): дата регистрации (т.е возраст автомобиля), мощность двигателя и пробег.
    - Характер влияния на цену автомобиля каждого из количественных, а также бинарных категориальных признаков (ручная или автоматическая коробка передач, факт пребывания в ремонте) соответствует здравому смыслу.


3. Сформулированы **рекомендации заказчику**:
    
    Для повышения качества предсказаний прогнозирующей модели нужно повысить качество исходных данных, используемых для её обучения. Для этого желательно: 
    - Ввести дополнительные проверки корректности вводимых пользователем значений при заполнении анкеты. Особенно это касается наиболее значимых для модели признаков: дата регистрации (год и месяц) и мощность двигателя. 
    - Увеличить количество возможных для ввода значений пробега (сейчас их всего 13). 